/**
 * Blurb - Javascript Notification Library.
 * Copyright (C) 2011 Alexandros Michael.
 * GNU General Public License.
 */
var Blurb=function(d){var e=false;var f=null;var g=null;var j=0;var k={backgroundColor:"#222",opacity:"0.8",padding:"5px 20px 5px 20px",color:"white",textShadow:"1px 2px black",fontFamily:"Helvetica Neue",fontSize:"0.86em"};this.options={position:"right-top",wrap:false,fadeInDuration:200,fadeOutDuration:100,displayDuration:3000,cssClass:"",cssStyle:k,content:"This is a nice notification.",showCloseButton:true};this._extend=function(a){if(!a){return}for(var i=1;i<arguments.length;i++){var b=arguments[i];for(prop in b){if(b.hasOwnProperty(prop)){a[prop]=b[prop]}}}return a};this._appendMessage=function(a,b){var c=$("<div/>").html(a||this.options.content).css({margin:"5px 0px 5px 0px",padding:"7px 0px 7px 0px"});if(b){c.css({borderTop:"1px solid #ddd"})};g.append(c)};this._makeVisible=function(){this._setPosition();if(this.options.showCloseButton){this._appendCloseBtn()}f.fadeIn(this.options.fadeInDuration)};this._wait=function(){window.clearTimeout(j);if(this.options.displayDuration<0){return}j=window.setTimeout($.proxy(function(){this.close()},this),this.options.displayDuration)};this._makeBase=function(){if(this.options.wrap){f=$("<div class='blurb-wrap'><div></div></div>");g=f.children("div")}else{f=$("<div></div>");g=f}var a=this.options.cssClass,cssStyle=this.options.cssStyle;if(a){g.addClass(a)}else{g.css(cssStyle||k)}};this._appendCloseBtn=function(){var a=((this.options.cssClass)?this.options.cssClass+"-":"")+"blurb-close-btn";var b=$("<div/>").addClass(a).click($.proxy(function(){this.close()},this));f.append(b)};this._setPosition=function(){var x=0;var y=0;f.css({display:"none",position:"fixed"});$("body").append(f);f.css(this._getCoords(this.options.position))};this._getCoords=function(a){if(!a){a="right-top"}var w=f.outerWidth(),h=f.outerHeight(),pad=10,center_y=$(window).height()/2-h/2-pad,center_x=$(window).width()/2-w/2-pad,x_="right",y_="top",x=0,y=0,posTokens=a.split(/-/),pixTokens=a.split(/\s+/);if(posTokens.length===2){if(posTokens[0]in["right, center, left"]){x_=(posTokens[0]==="center")?"left":posTokens[0]}if(posTokens[1]in["top, bottom, center"]){y_=(posTokens[1]==="center")?"top":posTokens[1]}switch(a){case"center-center":x=center_x;y=center_y;break;case"left-top":case"right-top":case"left-bottom":case"right-bottom":case"left-top":x=pad;y=pad;break;case"center-top":case"center-bottom":x=center_x;y=pad;break;case"left-center":case"right-center":x=pad;y=center_y;break}}else if(pixTokens.length==2){x=parseFloat(pixTokens[0]);y=parseFloat(pixTokens[1]);if(!x||!y){x=pad;y=pad}else{x_="left"}}else{x=pad;y=pad}var b={};b[x_]=x;b[y_]=y;return b};this.close=function(){f.fadeOut(this.options.fadeOutDuration,function(){g.children("div").remove();window.clearTimeout(j);e=false;f.remove()})};this.show=function(a){this._appendMessage(a,e);if(!e){e=true;this._makeVisible()}this._wait()};this.elem=function(){return f};if(d){this._extend(this.options,d)}this._makeBase()};